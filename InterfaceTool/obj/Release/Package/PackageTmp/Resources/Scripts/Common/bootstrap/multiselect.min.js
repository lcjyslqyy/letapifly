!function(n){"use strict";function t(t,i){this.options=this.mergeOptions(i);this.$select=n(t);this.originalOptions=this.$select.clone()[0].options;this.query="";this.searchTimeout=null;this.options.multiple=this.$select.attr("multiple")==="multiple";this.options.onChange=n.proxy(this.options.onChange,this);this.options.onDropdownShow=n.proxy(this.options.onDropdownShow,this);this.options.onDropdownHide=n.proxy(this.options.onDropdownHide,this);this.buildContainer();this.buildButton();this.buildSelectAll();this.buildDropdown();this.buildDropdownOptions();this.buildFilter();this.updateButtonText();this.updateSelectAll();this.$select.hide().after(this.$container)}typeof ko!="undefined"&&ko.bindingHandlers&&!ko.bindingHandlers.multiselect&&(ko.bindingHandlers.multiselect={init:function(){},update:function(t,i,r){var e=ko.utils.unwrapObservable(i()),f=r().options,u=n(t).data("multiselect");u?(u.updateOriginalOptions(),f&&f().length!==u.originalOptions.length&&n(t).multiselect("rebuild")):n(t).multiselect(e)}});t.prototype={defaults:{buttonText:function(t){if(t.length===0)return this.nonSelectedText+' <b class="caret"><\/b>';if(t.length>this.numberDisplayed)return t.length+" "+this.nSelectedText+' <b class="caret"><\/b>';var i="";return t.each(function(){var t=n(this).attr("label")!==undefined?n(this).attr("label"):n(this).html();i+=t+", "}),i.substr(0,i.length-2)+' <b class="caret"><\/b>'},buttonTitle:function(t){if(t.length===0)return this.nonSelectedText;var i="";return t.each(function(){i+=n(this).text()+", "}),i.substr(0,i.length-2)},label:function(t){return n(t).attr("label")||n(t).html()},onChange:function(){},onDropdownShow:function(){},onDropdownHide:function(){},buttonClass:"btn btn-default",dropRight:!1,selectedClass:"active",buttonWidth:"auto",buttonContainer:'<div class="btn-group" />',maxHeight:!1,includeSelectAllOption:!1,selectAllText:" Select all",selectAllValue:"multiselect-all",enableFiltering:!1,enableCaseInsensitiveFiltering:!1,filterPlaceholder:"Search",filterBehavior:"text",preventInputChangeEvent:!1,nonSelectedText:"None selected",nSelectedText:"selected",numberDisplayed:3},templates:{button:'<button type="button" class="multiselect dropdown-toggle" data-toggle="dropdown"><\/button>',ul:'<ul class="multiselect-container dropdown-menu"><\/ul>',filter:'<div class="input-group"><span class="input-group-addon"><i class="glyphicon glyphicon-search"><\/i><\/span><input class="form-control multiselect-search" type="text"><\/div>',li:'<li><a href="javascript:void(0);"><label><\/label><\/a><\/li>',divider:'<li class="divider"><\/li>',liGroup:'<li><label class="multiselect-group"><\/label><\/li>'},constructor:t,buildContainer:function(){this.$container=n(this.options.buttonContainer);this.$container.on("show.bs.dropdown",this.options.onDropdownShow);this.$container.on("hide.bs.dropdown",this.options.onDropdownHide)},buildButton:function(){this.$button=n(this.templates.button).addClass(this.options.buttonClass);this.$select.prop("disabled")?this.disable():this.enable();this.options.buttonWidth&&this.options.buttonWidth!="auto"&&this.$button.css({width:this.options.buttonWidth});var t=this.$select.attr("tabindex");t&&this.$button.attr("tabindex",t);this.$container.prepend(this.$button)},buildDropdown:function(){this.$ul=n(this.templates.ul);this.options.dropRight&&this.$ul.addClass("pull-right");this.options.maxHeight&&this.$ul.css({"max-height":this.options.maxHeight+"px","overflow-y":"auto","overflow-x":"hidden"});this.$container.append(this.$ul)},buildDropdownOptions:function(){this.$select.children().each(n.proxy(function(t,i){var r=n(i).prop("tagName").toLowerCase();r==="optgroup"?this.createOptgroup(i):r==="option"&&(n(i).data("role")==="divider"?this.createDivider():this.createOptionValue(i))},this));n("li input",this.$ul).on("change",n.proxy(function(t){var f=n(t.target).prop("checked")||!1,h=n(t.target).val()===this.options.selectAllValue,e,u,i;this.options.selectedClass&&(f?n(t.target).parents("li").addClass(this.options.selectedClass):n(t.target).parents("li").removeClass(this.options.selectedClass));var c=n(t.target).val(),r=this.getOptionByValue(c),o=n("option",this.$select).not(r),s=n("input",this.$container).not(n(t.target));if(h&&this.$select[0][0].value===this.options.selectAllValue){for(e=[],u=n('option[value!="'+this.options.selectAllValue+'"]',this.$select),i=0;i<u.length;i++)u[i].value!==this.options.selectAllValue&&this.getInputByValue(u[i].value).is(":visible")&&e.push(u[i].value);f?this.select(e):this.deselect(e)}f?(r.prop("selected",!0),this.options.multiple?r.prop("selected",!0):(this.options.selectedClass&&n(s).parents("li").removeClass(this.options.selectedClass),n(s).prop("checked",!1),o.prop("selected",!1),this.$button.click()),this.options.selectedClass==="active"&&o.parents("a").css("outline","")):r.prop("selected",!1);this.$select.change();this.options.onChange(r,f);return this.updateButtonText(),this.updateSelectAll(),this.options.preventInputChangeEvent?!1:void 0},this));n("li a",this.$ul).on("touchstart click",function(t){var r;if(t.stopPropagation(),t.shiftKey&&(r=n(t.target).prop("checked")||!1,r)){var i=n(t.target).parents("li:last").siblings('li[class="active"]:first'),u=n(t.target).parents("li").index(),f=i.index();u>f?n(t.target).parents("li:last").prevUntil(i).each(function(){n(this).find("input:first").prop("checked",!0).trigger("change")}):n(t.target).parents("li:last").nextUntil(i).each(function(){n(this).find("input:first").prop("checked",!0).trigger("change")})}n(t.target).blur()});this.$container.on("keydown",n.proxy(function(t){var r,i,f,u;if(!n('input[type="text"]',this.$container).is(":focus"))if((t.keyCode===9||t.keyCode===27)&&this.$container.hasClass("open"))this.$button.click();else{if(r=n(this.$container).find("li:not(.divider):visible a"),!r.length)return;i=r.index(r.filter(":focus"));t.keyCode===38&&i>0?i--:t.keyCode===40&&i<r.length-1?i++:~i||(i=0);f=r.eq(i);f.focus();(t.keyCode===32||t.keyCode===13)&&(u=f.find("input"),u.prop("checked",!u.prop("checked")),u.change());t.stopPropagation();t.preventDefault()}},this))},createOptionValue:function(t){var u,i;n(t).is(":selected")&&n(t).prop("selected",!0);var o=this.options.label(t),f=n(t).val(),e=this.options.multiple?"checkbox":"radio",r=n(this.templates.li);n("label",r).addClass(e);n("label",r).append('<input type="'+e+'" />');u=n(t).prop("selected")||!1;i=n("input",r);i.val(f);f===this.options.selectAllValue&&i.parent().parent().addClass("multiselect-all");n("label",r).append(" "+o);this.$ul.append(r);n(t).is(":disabled")&&i.attr("disabled","disabled").prop("disabled",!0).parents("li").addClass("disabled");i.prop("checked",u);u&&this.options.selectedClass&&i.parents("li").addClass(this.options.selectedClass)},createDivider:function(){var t=n(this.templates.divider);this.$ul.append(t)},createOptgroup:function(t){var r=n(t).prop("label"),i=n(this.templates.liGroup);n("label",i).text(r);this.$ul.append(i);n("option",t).each(n.proxy(function(n,t){this.createOptionValue(t)},this))},buildSelectAll:function(){var n=this.hasSelectAll();this.options.includeSelectAllOption&&this.options.multiple&&!n&&this.$select.prepend('<option value="'+this.options.selectAllValue+'">'+this.options.selectAllText+"<\/option>")},buildFilter:function(){if(this.options.enableFiltering||this.options.enableCaseInsensitiveFiltering){var t=Math.max(this.options.enableFiltering,this.options.enableCaseInsensitiveFiltering);if(this.$select.find("option").length>=t){this.$filter=n(this.templates.filter);n("input",this.$filter).attr("placeholder",this.options.filterPlaceholder);this.$ul.prepend(this.$filter);this.$filter.val(this.query).on("click",function(n){n.stopPropagation()}).on("input keydown",n.proxy(function(t){clearTimeout(this.searchTimeout);this.searchTimeout=this.asyncFunction(n.proxy(function(){this.query!==t.target.value&&(this.query=t.target.value,n.each(n("li",this.$ul),n.proxy(function(t,i){var f=n("input",i).val(),e=n("label",i).text(),u,r;f!==this.options.selectAllValue&&e&&(u=!1,r="",(this.options.filterBehavior==="text"||this.options.filterBehavior==="both")&&(r=e),(this.options.filterBehavior==="value"||this.options.filterBehavior==="both")&&(r=f),this.options.enableCaseInsensitiveFiltering&&r.toLowerCase().indexOf(this.query.toLowerCase())>-1?u=!0:r.indexOf(this.query)>-1&&(u=!0),u?n(i).show():n(i).hide())},this)))},this),300,this)},this))}}},destroy:function(){this.$container.remove();this.$select.show()},refresh:function(){n("option",this.$select).each(n.proxy(function(t,i){var r=n("li input",this.$ul).filter(function(){return n(this).val()===n(i).val()});n(i).is(":selected")?(r.prop("checked",!0),this.options.selectedClass&&r.parents("li").addClass(this.options.selectedClass)):(r.prop("checked",!1),this.options.selectedClass&&r.parents("li").removeClass(this.options.selectedClass));n(i).is(":disabled")?r.attr("disabled","disabled").prop("disabled",!0).parents("li").addClass("disabled"):r.prop("disabled",!1).parents("li").removeClass("disabled")},this));this.updateButtonText();this.updateSelectAll()},select:function(t){var i;for(t&&!n.isArray(t)&&(t=[t]),i=0;i<t.length;i++){var r=t[i],f=this.getOptionByValue(r),u=this.getInputByValue(r);this.options.selectedClass&&u.parents("li").addClass(this.options.selectedClass);u.prop("checked",!0);f.prop("selected",!0)}this.updateButtonText()},deselect:function(t){var i;for(t&&!n.isArray(t)&&(t=[t]),i=0;i<t.length;i++){var r=t[i],f=this.getOptionByValue(r),u=this.getInputByValue(r);this.options.selectedClass&&u.parents("li").removeClass(this.options.selectedClass);u.prop("checked",!1);f.prop("selected",!1)}this.updateButtonText()},rebuild:function(){this.$ul.html("");n('option[value="'+this.options.selectAllValue+'"]',this.$select).remove();this.options.multiple=this.$select.attr("multiple")==="multiple";this.buildSelectAll();this.buildDropdownOptions();this.buildFilter();this.updateButtonText();this.updateSelectAll()},dataprovider:function(n){var t="";n.forEach(function(n){t+='<option value="'+n.value+'">'+n.label+"<\/option>"});this.$select.html(t);this.rebuild()},enable:function(){this.$select.prop("disabled",!1);this.$button.prop("disabled",!1).removeClass("disabled")},disable:function(){this.$select.prop("disabled",!0);this.$button.prop("disabled",!0).addClass("disabled")},setOptions:function(n){this.options=this.mergeOptions(n)},mergeOptions:function(t){return n.extend({},this.defaults,t)},hasSelectAll:function(){return this.$select[0][0]?this.$select[0][0].value===this.options.selectAllValue:!1},updateSelectAll:function(){if(this.hasSelectAll()){var t=this.getSelected();t.length===n("option",this.$select).length-1?this.select(this.options.selectAllValue):this.deselect(this.options.selectAllValue)}},updateButtonText:function(){var t=this.getSelected();n("button",this.$container).html(this.options.buttonText(t,this.$select));n("button",this.$container).attr("title",this.options.buttonTitle(t,this.$select))},getSelected:function(){return n('option[value!="'+this.options.selectAllValue+'"]:selected',this.$select).filter(function(){return n(this).prop("selected")})},getOptionByValue:function(t){return n("option",this.$select).filter(function(){return n(this).val()===t})},getInputByValue:function(t){return n("li input",this.$ul).filter(function(){return n(this).val()===t})},updateOriginalOptions:function(){this.originalOptions=this.$select.clone()[0].options},asyncFunction:function(n,t,i){var r=Array.prototype.slice.call(arguments,3);return setTimeout(function(){n.apply(i||window,r)},t)}};n.fn.multiselect=function(i,r){return this.each(function(){var u=n(this).data("multiselect"),f=typeof i=="object"&&i;u||n(this).data("multiselect",u=new t(this,f));typeof i=="string"&&u[i](r)})};n.fn.multiselect.Constructor=t;n(function(){n("select[data-role=multiselect]").multiselect()})}(window.jQuery);
/*
//# sourceMappingURL=multiselect.min.js.map
*/